
<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-115075361-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

<!DOCTYPE html>
<html xmlns="//www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
    <head>
        
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

        <title>An Introduction to Bayesian VAR (BVAR) Models &middot; r-econometrics</title>
        <link rel='stylesheet' href='//fonts.googleapis.com/css?family=Open+Sans:400,300,600' type='text/css'>
        <link rel="stylesheet" href="//libraries/normalize.3.0.1.css" />
        <link rel="stylesheet" href="//css/liquorice.css" />
        <link rel="shortcut icon" href="/favicon.ico" />
        <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-144-precomposed.png" sizes="144x144" />
        <link rel="alternate" href="" type="application/rss+xml" title="r-econometrics" />
    </head>
    <body class="li-body">

<header class="li-page-header">
    <div class="container">
        <div class="row">
            <div class="sixteen columns">
                <div class="li-brand li-left">
                <a href="/">r-econometrics</a></div>
                <div class="li-menu li-right">
                    <span class="li-menu-icon" onclick="javascript:toggle('menu');">&#9776;</span>
                    <ul id="menu2" class="li-menu-items">
                        
                            <li><a href="/rbasicsintro"> R(eal) Basics </a></li>
                        
                            <li><a href="/methodsintro"> Econometric Methods </a></li>
                        
                            <li><a href="/timeseriesintro"> Time Series Topics </a></li>
                        
                            <li><a href="/links"> Links </a></li>
                        
                            <li><a href="/post"> Blog </a></li>
                        
                            <li><a href="/reproductionintro"> Reproduction Projects </a></li>
                        
                            <li><a href="/about"> About and Disclaimer </a></li>
                        
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="sixteen columns">
                <ul id="menu" class="li-menu-items li-menu-mobile">
                    
                        <li><a href="/rbasicsintro"> R(eal) Basics </a></li>
                    
                        <li><a href="/methodsintro"> Econometric Methods </a></li>
                    
                        <li><a href="/timeseriesintro"> Time Series Topics </a></li>
                    
                        <li><a href="/links"> Links </a></li>
                    
                        <li><a href="/post"> Blog </a></li>
                    
                        <li><a href="/reproductionintro"> Reproduction Projects </a></li>
                    
                        <li><a href="/about"> About and Disclaimer </a></li>
                    
                </ul>
            </div>
        </div>
    </div>
</header>






    <div class="container">
        <div class="row">
            <div class="sixteen columns">
                <article class="li-article">
                    <header class="li-article-header">
                        <h1 class="li-article-title">An Introduction to Bayesian VAR (BVAR) Models</h1>
                        <span class="li-article-taxonomies">
                            

                            
                                with tags
                                
                                    <a href="//tags/r">r</a>
                                
                                    <a href="//tags/bvar">bvar</a>
                                
                                    <a href="//tags/var">var</a>
                                
                                    <a href="//tags/bayes">bayes</a>
                                
                                    <a href="//tags/bayesian-var">bayesian-var</a>
                                
                                    <a href="//tags/bvartools">bvartools</a>
                                
                                    <a href="//tags/gibbs-sampler">gibbs-sampler</a>
                                
                            
                        </span>
                         - 
                        <time class="li-article-date">Franz X. Mohr, July 15, 2019
                        </time>
                    </header>
                    <section>
                        <p>Bayesian methods have significantly gained in popularity during the last decades as computers have become more powerful and new software has been developed. These methods are also becoming more popular in econometric applications, due to their flexibility and other general features. This post gives a brief introduction to Bayesian VAR (BVAR) models and provides the code to set up and estimate a basic model with the <a href="https://cran.r-project.org/package=bvartools"><code>bvartools</code></a> package.</p>
<!--more-->
<div id="bvar-models" class="section level2">
<h2>BVAR models</h2>
<p>Kennedy (2008, ch. 14) provides a short introduction to the Bayesian approach and contains a series of references for interested readers.</p>
<p>BVAR models have the same mathematical form as any other <a href="/timeseries/varintro">VAR model</a>. The only difference is the way, how the parameter estimates are obtained (and interpreted!). VAR models are usually estimated by <a href="/methods/ols">OLS</a>, which is a simple and computationally fast estimator. By contrast, Bayesian estimators are slightly more complicated and more burdensome in terms of calculation power. However, they are very flexible and, thus, very powerful tools in the econometric toolbox.[cpp]</p>
<!-- While the coefficients obtaind by *frequentist* estimators like OLS get their meaning from the distribution of the models' variables, Bayesian inference assumes that the coefficients have their own distribution. -->
<!-- A common implementation of a Bayesian estimator is a so-called **Gibbs sampler**, which belongs to the family of Markov-Chain-Monte-Carlo methods. A detailed treatment of this method is beyond the scope of this post, but [Wikipedia](https://en.wikipedia.org/wiki/Gibbs_sampling) might be a good start to become familiar with it. Personally, I like to think of the Gibbs sampler as throwing a bunch of random numbers at a model and see what sticks. -->
<!-- Koop and Korobilis (2010) provide a very good introduction to Bayesian VAR estimators. -->
<!-- This vignette provides the code to set up and estimate a basic Bayesian VAR (BVAR) model with the `bvartools` package. For this illustration the dataset E1 from Lütkepohl (2007) is used. It contains data on West German fixed investment, disposable income and consumption expenditures in billions of DM from 1960Q1 to 1982Q4. -->
<!-- ```{r data, fig.align='center', fig.height=5, fig.width=4.5} -->
<!-- library(bvartools) -->
<!-- data("e1") -->
<!-- e1 <- diff(log(e1)) -->
<!-- plot(e1) # Plot the series -->
<!-- ``` -->
<!-- The `gen_var` function produces the inputs `y` and `x` for the BVAR estimator, where `y` is a matrix of dependent variables and `x` is the matrix of regressors for the model -->
<!-- $$y_t = A x_t + u_t,$$ -->
<!-- with $u_t \sim N(0, \Sigma)$. -->
<!-- ```{r} -->
<!-- data <- gen_var(e1, p = 2, deterministic = "const") -->
<!-- y <- data$Y[, 1:73] -->
<!-- x <- data$Z[, 1:73] -->
<!-- ``` -->
<!-- As in Lütkepohl (2007) only the first 73 observations are used. -->
<!-- ## Estimation -->
<!-- ### Frequentist estimator -->
<!-- We calculate frequentist VAR estimates using the standard formula $y x' (x x')^{-1}$ to obtain a benchmark for the Bayesian estimator. The parameters are obtained by OLS: -->
<!-- ```{r} -->
<!-- A_freq <- tcrossprod(y, x) %*% solve(tcrossprod(x)) # Calculate estimates -->
<!-- round(A_freq, 3) # Round estimates and print -->
<!-- ``` -->
<!-- And $\Sigma$ is calculated by -->
<!-- ```{r} -->
<!-- u_freq <- y - A_freq %*% x -->
<!-- u_sigma_freq <- tcrossprod(u_freq) / (ncol(y) - nrow(x)) -->
<!-- round(u_sigma_freq * 10^4, 2) -->
<!-- ``` -->
<!-- These are the same values as in Lütkepohl (2007). -->
<!-- ### Bayesian estimator -->
<!-- The following code is a Gibbs sampler for a simple VAR model with non-informative priors. -->
<!-- ```{r flat prior} -->
<!-- # Reset random number generator for reproducibility -->
<!-- set.seed(1234567) -->
<!-- iter <- 10000 # Number of iterations of the Gibbs sampler -->
<!-- burnin <- 5000 # Number of burn-in draws -->
<!-- store <- iter - burnin -->
<!-- t <- ncol(y) # Number of observations -->
<!-- k <- nrow(y) # Number of endogenous variables -->
<!-- m <- k * nrow(x) # Number of estimated coefficients -->
<!-- # Set (uninformative) priors -->
<!-- a_mu_prior <- matrix(0, m) # Vector of prior parameter means -->
<!-- a_v_i_prior <- diag(0, m) # Inverse of the prior covariance matrix -->
<!-- u_sigma_df_prior <- 0 # Prior degrees of freedom -->
<!-- u_sigma_scale_prior <- diag(0, k) # Prior covariance matrix -->
<!-- u_sigma_df_post <- t + u_sigma_df_prior # Posterior degrees of freedom -->
<!-- # Initial values -->
<!-- u_sigma_i <- diag(.00001, k) -->
<!-- u_sigma <- solve(u_sigma_i) -->
<!-- # Data containers for posterior draws -->
<!-- draws_a <- matrix(NA, m, store) -->
<!-- draws_sigma <- matrix(NA, k^2, store) -->
<!-- # Start Gibbs sampler -->
<!-- for (draw in 1:iter) { -->
<!--   # Draw conditional mean parameters -->
<!--   a <- post_normal(y, x, u_sigma_i, a_mu_prior, a_v_i_prior) -->
<!--   # Draw variance-covariance matrix -->
<!--   u <- y - matrix(a, k) %*% x # Obtain residuals -->
<!--   u_sigma_scale_post <- solve(u_sigma_scale_prior + tcrossprod(u)) -->
<!--   u_sigma_i <- matrix(rWishart(1, u_sigma_df_post, u_sigma_scale_post)[,, 1], k) -->
<!--   u_sigma <- solve(u_sigma_i) # Invert Sigma_i to obtain Sigma -->
<!--   # Store draws -->
<!--   if (draw > burnin) { -->
<!--     draws_a[, draw - burnin] <- a -->
<!--     draws_sigma[, draw - burnin] <- u_sigma -->
<!--   } -->
<!-- } -->
<!-- ``` -->
<!-- After the Gibbs sampler has finished, point estimates can be obtained as the mean of the posterior draws: -->
<!-- ```{r} -->
<!-- A <- rowMeans(draws_a) # Obtain means for every row -->
<!-- A <- matrix(A, k) # Transform mean vector into a matrix -->
<!-- A <- round(A, 3) # Round values -->
<!-- dimnames(A) <- list(dimnames(y)[[1]], dimnames(x)[[1]]) # Rename matrix dimensions -->
<!-- A # Print -->
<!-- ``` -->
<!-- ```{r} -->
<!-- Sigma <- rowMeans(draws_sigma) # Obtain means for every row -->
<!-- Sigma <- matrix(Sigma, k) # Transform mean vector into a matrix -->
<!-- Sigma <- round(Sigma * 10^4, 2) # Round values -->
<!-- dimnames(Sigma) <- list(dimnames(y)[[1]], dimnames(y)[[1]]) # Rename matrix dimensions -->
<!-- Sigma # Print -->
<!-- ``` -->
<!-- The means of the coefficient draws are very close to the results of the frequentist estimatior, which would be expected with non-informative priors. -->
<!-- ## `bvar` objects -->
<!-- The `bvar` function can be used to collect relevant output of the Gibbs sampler into a standardised object, which can be used by further functions such as `predict` to obtain forecasts or `irf` for impulse respons analysis. -->
<!-- ```{r bvar-object} -->
<!-- bvar_est <- bvar(y = y, x = x, A = draws_a[1:18,], -->
<!--                  C = draws_a[19:21, ], Sigma = draws_sigma) -->
<!-- ``` -->
<!-- Posterior draws can be thinned with function `thin`: -->
<!-- ```{r thin} -->
<!-- bvar_est <- thin(bvar_est, thin = 5) -->
<!-- ``` -->
<!-- ## Forecasts -->
<!-- Forecasts with credible bands can be obtained with the function `predict`. If the model contains deterministic terms, new values can be provided in the argument `new_D`. If no values are provided, the function sets them to zero. The number of rows of `new_D` must be the same as the argument `n.ahead`. -->
<!-- ```{r forecasts, fig.width=5.5, fig.height=5.5} -->
<!-- bvar_pred <- predict(bvar_est, n.ahead = 10, new_D = rep(1, 10)) -->
<!-- plot(bvar_pred) -->
<!-- ``` -->
<!-- ## Impulse response analysis -->
<!-- Currently, `bvartools` supports forecast error, orthogonalised, and generalised impulse response functions. -->
<!-- ### Forecast error impulse response -->
<!-- ```{r feir, fig.width=5.5, fig.height=4.5} -->
<!-- FEIR <- irf(bvar_est, impulse = "income", response = "cons", n.ahead = 8) -->
<!-- plot(FEIR, main = "Forecast Error Impulse Response", xlab = "Period", ylab = "Response") -->
<!-- ``` -->
<!-- ### Orthogonalised impulse response -->
<!-- ```{r oir, fig.width=5.5, fig.height=4.5} -->
<!-- OIR <- irf(bvar_est, impulse = "income", response = "cons", n.ahead = 8, type = "oir") -->
<!-- plot(OIR, main = "Orthogonalised Impulse Response", xlab = "Period", ylab = "Response") -->
<!-- ``` -->
<!-- ### Generalised impulse response -->
<!-- ```{r gir, fig.width=5.5, fig.height=4.5} -->
<!-- GIR <- irf(bvar_est, impulse = "income", response = "cons", n.ahead = 8, type = "gir") -->
<!-- plot(GIR, main = "Generalised Impulse Response", xlab = "Period", ylab = "Response") -->
<!-- ``` -->
<!-- ## Forecast error variance decomposition -->
<!-- Default forecast error variance decomposition (FEVD) is based on orthogonalised impulse responses (OIR). -->
<!-- ```{r fevd-oir, fig.width=5.5, fig.height=4.5} -->
<!-- bvar_fevd_oir <- fevd(bvar_est, response = "cons") -->
<!-- plot(bvar_fevd_oir, main = "OIR-based FEVD of consumption") -->
<!-- ``` -->
<!-- It is also possible to calculate FEVDs, which are based on generalised impulse responses (GIR). Note that these do not automatically add up to unity. -->
<!-- ```{r fevd-gir, fig.width=5.5, fig.height=4.5} -->
<!-- bvar_fevd_gir <- fevd(bvar_est, response = "cons", type = "gir") -->
<!-- plot(bvar_fevd_gir, main = "GIR-based FEVD of consumption") -->
<!-- ``` -->
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Eddelbuettel, D., &amp; Sanderson C. (2014). RcppArmadillo: Accelerating R with high-performance C++ linear algebra. <em>Computational Statistics and Data Analysis, 71</em>, 1054-1063. <a href="https://doi.org/10.1016/j.csda.2013.02.005" class="uri">https://doi.org/10.1016/j.csda.2013.02.005</a></p>
<p>Koop, G., &amp; Korobilis, D. (2010). Bayesian multivariate time series methods for empirical macroeconomics. <em>Foundations and trends in econometrics, 3</em>(4), 267-358. <a href="https://dx.doi.org/10.1561/0800000013" class="uri">https://dx.doi.org/10.1561/0800000013</a></p>
<p>Koop, G., Pesaran, M. H., &amp; Potter, S.M. (1996). Impulse response analysis in nonlinear multivariate models. <em>Journal of Econometrics 74</em>(1), 119-147. <a href="https://doi.org/10.1016/0304-4076(95)01753-4" class="uri">https://doi.org/10.1016/0304-4076(95)01753-4</a></p>
<p>Lütkepohl, H. (2007). <em>New introduction to multiple time series analysis</em> (2nd ed.). Berlin: Springer.</p>
<p>Kennedy, P. (2008). <em>A guide to econometrics</em> (6th ed.) Malden, MA: Blackwell.</p>
<p>Pesaran, H. H., &amp; Shin, Y. (1998). Generalized impulse response analysis in linear multivariate models. <em>Economics Letters, 58</em>(1), 17-29. <a href="https://doi.org/10.1016/S0165-1765(97)00214-0" class="uri">https://doi.org/10.1016/S0165-1765(97)00214-0</a></p>
<p>Plummer, M., Best, N., Cowles, K., &amp; Vines, K. (2006). CODA: Convergence Diagnosis and Output Analysis for MCMC. <em>R News, 6</em>(1), 7-11. <a href="https://www.r-project.org/doc/Rnews/Rnews_2006-1.pdf" class="uri">https://www.r-project.org/doc/Rnews/Rnews_2006-1.pdf</a></p>
<p>Sanderson, C., &amp; Curtin, R. (2016). Armadillo: a template-based C++ library for linear algebra. <em>Journal of Open Source Software, 1</em>(2), 26. <a href="https://doi.org/10.21105/joss.00026" class="uri">https://doi.org/10.21105/joss.00026</a></p>
</div>

                    </section>
                </article>
                <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a9c6c9b8a39890d"></script>
                <div class="container">
  <div class="row">
    <div class="sixteen columns center">
      <div class="addthis_inline_share_toolbox"></div>
      
    </div>
  </div>
</div>

                <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<footer class="li-page-footer">
    <div class="container">
        <div class="row">
            <div class="sixteen columns center">
              <div id="disqus_thread"></div>
                <script type="text/javascript">
                  (function() { 
                  if (window.location.hostname == "localhost") return;
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  var disqus_shortname = 'r-econometrics';
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                  })();
                  </script>
                  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                  <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </div>
        </div>
    </div>
</footer>
            </div>
        </div>
        
    </div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<footer class="li-page-footer">
    <div class="container">
        <div class="row">
            <div class="sixteen columns center">
              <div class="li-page-footer-legal">
                &copy; Franz X. Mohr. Powered by <a href="https://github.com/rstudio/blogdown" target="_blank" >Blogdown</a> and hosted by <a href="https://www.netlify.com/" target="_blank" >Netlify</a>. Source available on <a href="https://github.com/rranzmohr/r-econometrics" target="_blank" >Github</a>.
              </div>
              <div class="li-page-footer-theme">
                <span class=""><a href="https://github.com/eliasson/liquorice/">liquorice</a> is a theme for <a href="https://gohugo.io/">hugo</a>
                </span>
              </div>
            </div>
        </div>
    </div>
</footer>
    <script type="text/javascript">
    <!--
    function toggle(id) {
        var e = document.getElementById(id);
        e.style.display == 'block' ? e.style.display = 'none' : e.style.display = 'block';
    }
    
    </script>
    
<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-115075361-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </body>
</html>

